{"ast":null,"code":"import request from \"@/utils/request\";\nimport Header from \"@/components/Header.vue\";\nexport default {\n  // eslint-disable-next-line vue/multi-word-component-names\n  name: \"product\",\n  components: {\n    Header\n  },\n\n  data() {\n    return {\n      url: '',\n      form: {},\n      dialogVisible: false,\n      dialogVisible2: false,\n      dialogVisible3: false,\n      dialogVisible4: false,\n      currentPage: 1,\n      pageSize: 10,\n      total: 10,\n      search: '',\n      tableData: [],\n      rooms: [{\n        'name': 'outside',\n        'id': 1,\n        'gold': '1',\n        'cost': '-1',\n        'descriptions': 'outside the main entrance of the colossal cave',\n        'picture': 'assets/images/outside.jpg',\n        'takeflag': 0\n      }, {\n        'name': 'theater',\n        'id': 2,\n        'gold': '2',\n        'cost': '-1',\n        'descriptions': 'in the theater ,Mysterious songs are scattered throughout the opera house',\n        'picture': 'assets/images/theater.jpg',\n        'takeflag': 0\n      }, {\n        'name': 'pub',\n        'id': 3,\n        'gold': '4',\n        'cost': '-3',\n        'descriptions': 'in the quiet bar, the clinking sound of wine glasses',\n        'picture': 'assets/images/pub.jpg',\n        'takeflag': 0\n      }, {\n        'name': 'lab',\n        'id': 4,\n        'gold': '3',\n        'cost': '-2',\n        'descriptions': 'in a scientific laboratory, only the sound of machines running',\n        'picture': 'assets/images/lab.jpg',\n        'takeflag': 0\n      }, {\n        'name': 'treasure',\n        'id': 5,\n        'gold': '5',\n        'cost': '-1',\n        'descriptions': 'in the treasure room, maybe there has some treasure',\n        'picture': 'assets/images/treasure.jpg',\n        'takeflag': 0\n      }, {\n        'name': 'randomRoom',\n        'id': 6,\n        'gold': '0',\n        'cost': '0',\n        'descriptions': 'in a random room,where do you want to go',\n        'picture': 'assets/images/randomroom.jpg',\n        'takeflag': 1\n      }, {\n        'name': 'exit',\n        'id': 7,\n        'gold': '0',\n        'cost': '0',\n        'descriptions': 'a way to leave this place!',\n        'picture': 'assets/images/exit.jpg',\n        'takeflag': 0\n      }, {\n        'name': 'corridor',\n        'id': 8,\n        'gold': '0',\n        'cost': '0',\n        'descriptions': 'a long long corridor with cold wind',\n        'picture': 'assets/images/corridor.jpg',\n        'takeflag': 1\n      }],\n      items: [{\n        'name': 'cookie',\n        'id': 1,\n        'roomId': 5,\n        'descriptions': '增加5体力'\n      }, {\n        'name': 'key',\n        'id': 2,\n        'roomId': 7,\n        'descriptions': '通关的关键物品'\n      }],\n      //物品设置\n      location: '',\n      //当前位置\n      gold: '',\n      //金币\n      cost: '',\n      //体力消耗\n      descriptions: '',\n      //房间描述\n      id: '',\n      //房间id\n      lastroom: '',\n      //上次房间信息\n      powerFlag: false,\n      //玩家体力状态\n      maps: [[1, 2, 3], [5, 6, 4], [8, 7, 0]] //地图\n\n    };\n  },\n\n  created() {\n    this.load();\n  },\n\n  methods: {\n    /**\r\n     * @description 游戏规则说明\r\n     * @return void\r\n     * */\n    open() {\n      this.$notify({\n        title: '游戏规则说明',\n        message: '巨洞探险：一个精彩的、充满想像力的复杂游戏，包括要在一个复杂的洞穴系统中找到出路、寻找隐藏的财宝、使用暗语和其他一些神秘工具，最终的目的是获得高分。',\n        duration: 4500\n      });\n    },\n\n    /**\r\n     * @description 获取随机数函数\r\n     * @param {int} min\r\n     * @param {int} max\r\n     * @return {int} 随机数值\r\n     * */\n    getRandomInt1(min, max) {\n      min = Math.ceil(min);\n      max = Math.floor(max);\n      return Math.floor(Math.random() * (max - min)) + min; //不含最大值，含最小值\n    },\n\n    /**\r\n     * @description 加载页面信息\r\n     * @return void\r\n     * */\n    load() {\n      request.get(\"/user\").then(res => {\n        this.tableData = res.data.records;\n        this.total = res.data.total;\n        let user = JSON.parse(sessionStorage.getItem(\"user\"));\n\n        for (let data in res.data.records) {\n          if (res.data.records[data].id === user[\"id\"]) {\n            this.location = res.data.records[data].currentroom;\n            this.lastroom = res.data.records[data].lastroom;\n          }\n        }\n\n        for (let index in this.rooms) {\n          let map = this.rooms[index];\n\n          if (map['name'] === this.location) {\n            this.gold = map['gold'];\n            this.cost = map['cost'];\n            this.descriptions = \"Now,you are \" + map['descriptions'];\n            this.id = map['id'];\n            this.url = require(\"@/\" + this.rooms[this.id - 1]['picture']);\n          }\n        }\n\n        if (this.location === \"randomRoom\") {\n          alert(\"您处于随机房间，将会被传送离开\");\n          this.portal();\n        }\n      });\n    },\n\n    /**\r\n     * @description 传送至randomRoom四周任意房间\r\n     * @return void\r\n     * */\n    portal() {\n      let a = this.getRandomInt1(1, 5);\n\n      switch (a) {\n        case 1:\n          this.move(0, -1);\n          break;\n\n        case 2:\n          this.move(0, 1);\n          break;\n\n        case 3:\n          this.move(-1, 0);\n          break;\n\n        case 4:\n          this.move(1, 0);\n          break;\n      }\n    },\n\n    /**\r\n     * @description 拿取房间内物品\r\n     * @return void\r\n     * */\n    take() {\n      let judgeFlag;\n      let num;\n\n      for (let index in this.rooms) {\n        if (this.rooms[index].name === this.location) {\n          judgeFlag = this.rooms[index].takeflag;\n          num = index;\n        }\n      }\n\n      if (judgeFlag == 1) {\n        alert(\"房间内无物品可以拿取\");\n      } else {\n        let oldgold;\n        let oldcoin;\n        request.get(\"/user\").then(res => {\n          let user = JSON.parse(sessionStorage.getItem(\"user\"));\n\n          for (let data in res.data.records) {\n            if (res.data.records[data].id === user[\"id\"]) {\n              oldgold = res.data.records[data].gold;\n              oldcoin = res.data.records[data].coin;\n            }\n          }\n\n          let gold = (parseInt(oldgold) + parseInt(this.gold)).toString();\n          let coin = (parseInt(oldcoin) + parseInt(this.cost)).toString();\n          let mesage = \"gold+\" + this.gold + \"  power\" + this.cost;\n\n          for (let index in this.items) {\n            if (this.items[index].roomId === parseInt(this.id)) {\n              if (parseInt(coin) < 0) {\n                this.$message({\n                  type: \"error\",\n                  message: \"您的体力不足\"\n                });\n                return;\n              } else {\n                coin = (parseInt(coin) + 5).toString();\n                mesage = mesage + \" you get a \" + this.items[index].name + \" your power +5\";\n              }\n            }\n          }\n\n          let data = {\n            \"id\": user[\"id\"],\n            \"name\": user[\"name\"],\n            \"password\": user[\"password\"],\n            \"gender\": user[\"gender\"],\n            \"currentroom\": this.location,\n            \"gold\": gold,\n            \"coin\": coin\n          };\n          request.put(\"/user\", data).then(res => {\n            console.log(res);\n\n            if (res.code === \"0\") {\n              this.$message({\n                type: \"success\",\n                message: mesage\n              });\n            } else {\n              this.$message({\n                type: \"error\",\n                message: res.msg\n              });\n            }\n\n            if (this.location === \"exit\") {\n              this.dialogVisible3 = true;\n            }\n\n            this.load();\n          });\n        });\n        judgeFlag = 1;\n        this.rooms[num].takeflag = 1;\n      }\n    },\n\n    /**\r\n     * @description 刷新用户信息\r\n     * */\n    refresh() {\n      let oldgold;\n      let oldcoin;\n      request.get(\"/user\").then(res => {\n        let user = JSON.parse(sessionStorage.getItem(\"user\"));\n\n        for (let data in res.data.records) {\n          if (res.data.records[data].id === user[\"id\"]) {\n            oldgold = res.data.records[data].gold;\n            oldcoin = res.data.records[data].coin;\n          }\n        }\n\n        oldcoin = (parseInt(oldcoin) - 1).toString();\n\n        if (parseInt(oldcoin) <= 0) {\n          //体力不足\n          this.dialogVisible4 = true;\n        } else {\n          let data = {\n            \"id\": user[\"id\"],\n            \"name\": user[\"name\"],\n            \"password\": user[\"password\"],\n            \"gender\": user[\"gender\"],\n            \"currentroom\": this.location,\n            \"gold\": oldgold,\n            \"coin\": oldcoin,\n            \"lastroom\": this.lastroom\n          };\n          request.put(\"/user\", data).then(res => {\n            if (res.code === \"0\") {\n              this.$message({\n                type: \"success\",\n                message: \"成功\"\n              });\n            } else {\n              this.$message({\n                type: \"error\",\n                message: res.msg\n              });\n            }\n\n            this.load();\n          });\n        }\n      });\n    },\n\n    /**\r\n     * @description 获取当前地图上玩家所处的位置\r\n     * @return {array} 玩家所处的位置坐标数组，例如 [x, y]，x 表示行，y 表示列\r\n     **/\n    getPlayerPosition() {\n      for (let i = 0; i < 3; i++) {\n        for (let j = 0; j < 3; j++) {\n          if (this.maps[i][j] === this.id) {\n            return [i, j];\n          }\n        }\n      }\n    },\n\n    /**\r\n     * @description 判断新位置是否有效\r\n     * @param {array} newPosition 新位置的坐标数组，例如 [x, y]，x 表示行，y 表示列\r\n     * @return {boolean} 若新位置有效则返回 true，否则返回 false\r\n     **/\n    isValidPosition(newPosition) {\n      const [x, y] = newPosition;\n      return x >= 0 && y >= 0 && x <= 2 && y <= 2 && this.maps[x][y] !== 0;\n    },\n\n    /**\r\n     * @description 根据新位置更新玩家状态\r\n     * @param {array} newPosition 新位置的坐标数组，例如 [x, y]，x 表示行，y 表示列\r\n     * @return void\r\n     **/\n    updatePlayerStatus(newPosition) {\n      for (let index in this.rooms) {\n        let map = this.rooms[index];\n\n        if (map['id'] === this.maps[newPosition[0]][newPosition[1]]) {\n          this.location = map['name'];\n          this.refresh();\n        }\n      }\n    },\n\n    /**\r\n     * @description 移动玩家到新位置\r\n     * @param {int} deltaX 表示南北方向的移动\r\n     * @param {int} deltaY 表示东西方向的移动\r\n     * @return void\r\n     **/\n    move(deltaX, deltaY) {\n      const [x, y] = this.getPlayerPosition();\n      const newPosition = [x + deltaX, y + deltaY];\n\n      if (this.isValidPosition(newPosition)) {\n        this.updatePlayerStatus(newPosition);\n      } else {\n        alert(\"此路不通\");\n      }\n    },\n\n    /**\r\n     * @description 返回上一房间\r\n     * @return void\r\n     * */\n    back() {\n      let lastroom = this.lastroom;\n      this.lastroom = this.location;\n      this.location = lastroom;\n      this.refresh();\n    },\n\n    /**\r\n     * @description 保存状态信息\r\n     * @return void\r\n     * */\n    save() {\n      if (this.form.id) {\n        request.put(\"/user\", this.form).then(res => {\n          console.log(res);\n\n          if (res.code === \"0\") {\n            this.$message({\n              type: \"success\",\n              message: \"更新成功\"\n            });\n          } else {\n            this.$message({\n              type: \"error\",\n              message: res.msg\n            });\n          }\n\n          this.load();\n          this.dialogVisible = false;\n        });\n      }\n    },\n\n    // eslint-disable-next-line no-unused-vars\n\n    /**\r\n     * @description 游戏胜利\r\n     * @return void\r\n     * */\n    gameWin() {\n      this.dialogVisible3 = false;\n      this.reset();\n    },\n\n    /**\r\n     * @description 游戏结束（未获胜）\r\n     * @return void\r\n     * */\n    gameOver() {\n      this.dialogVisible4 = false;\n      this.reset();\n    },\n\n    /**\r\n     * @description 重置玩家状态\r\n     * @return void\r\n     * */\n    reset() {\n      request.get(\"/user\").then(res => {\n        let user = JSON.parse(sessionStorage.getItem(\"user\"));\n        let oldgold;\n        let oldcoin;\n\n        for (let data in res.data.records) {\n          if (res.data.records[data].id === user[\"id\"]) {\n            oldgold = res.data.records[data].gold;\n            oldcoin = res.data.records[data].coin;\n          }\n        }\n\n        oldgold = \"0\";\n        oldcoin = \"20\";\n        let data = {\n          \"id\": user[\"id\"],\n          \"name\": user[\"name\"],\n          \"password\": user[\"password\"],\n          \"gender\": user[\"gender\"],\n          \"currentroom\": \"outside\",\n          \"gold\": oldgold,\n          \"coin\": oldcoin\n        };\n        request.put(\"/user\", data).then(res => {\n          console.log(res);\n\n          if (res.code === \"0\") {\n            this.$message({\n              type: \"success\",\n              message: res.msg\n            });\n          } else {\n            this.$message({\n              type: \"error\",\n              message: res.msg\n            });\n          }\n\n          this.load();\n        });\n      });\n\n      for (let index in this.rooms) {\n        this.rooms[index].takeflag = 0;\n      }\n\n      this.rooms[8].takeflag = 1;\n      this.rooms[6].takeflag = 1;\n    }\n\n  }\n};","map":{"version":3,"mappings":"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","names":["request","Header","name","components","data","url","form","dialogVisible","dialogVisible2","dialogVisible3","dialogVisible4","currentPage","pageSize","total","search","tableData","rooms","items","location","gold","cost","descriptions","id","lastroom","powerFlag","maps","created","load","methods","open","$notify","title","message","duration","getRandomInt1","min","max","Math","ceil","floor","random","get","then","res","records","user","JSON","parse","sessionStorage","getItem","currentroom","index","map","require","alert","portal","a","move","take","judgeFlag","num","takeflag","oldgold","oldcoin","coin","parseInt","toString","mesage","roomId","$message","type","put","console","log","code","msg","refresh","getPlayerPosition","i","j","isValidPosition","newPosition","x","y","updatePlayerStatus","deltaX","deltaY","back","save","gameWin","reset","gameOver"],"sourceRoot":"","sources":["D:\\JLSource\\软工实践2\\sept2-mars\\前端\\vue-demo01\\src\\views\\Game.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <Header />\r\n  </div>\r\n\r\n  <el-image style=\"width: 90%; height:80%\" :src=\"url\" />\r\n\r\n  <div class=\"a\">\r\n  <el-descriptions title=\"\" :column=\"3\" border>\r\n    <el-descriptions-item\r\n        label=\"房间名\"\r\n        label-align=\"right\"\r\n        align=\"center\"\r\n        label-class-name=\"my-label\"\r\n        class-name=\"my-content\"\r\n        width=\"150px\"\r\n    >{{location}}</el-descriptions-item\r\n    >\r\n    <el-descriptions-item label=\"gold\" label-align=\"right\" align=\"center\"\r\n    >{{gold}}</el-descriptions-item\r\n    >\r\n    <el-descriptions-item label=\"cost\" label-align=\"right\" align=\"center\"\r\n    >{{cost}}</el-descriptions-item\r\n    >\r\n    <el-descriptions-item label=\"Remarks\" label-align=\"right\" align=\"center\">\r\n      <el-tag size=\"small\">Room</el-tag>\r\n    </el-descriptions-item>\r\n    <el-descriptions-item label=\"房间描述信息\" label-align=\"right\" align=\"center\"\r\n    >{{descriptions}}</el-descriptions-item\r\n    >\r\n  </el-descriptions>\r\n  </div>\r\n  <div class=\"b\">\r\n      <el-row class=\"mb-4\">\r\n        <el-button type=\"success\" plain @click=\"move(0,-1)\">WEST </el-button>\r\n        <el-button type=\"success\" plain @click=\"move(0,1)\">EAST </el-button>\r\n        <el-button type=\"success\" plain @click=\"move(-1,0)\">NORTH</el-button>\r\n        <el-button type=\"success\" plain @click=\"move(1,0)\">SOUTH</el-button>\r\n        <el-button type=\"success\" plain @click=\"back\">BACK</el-button>\r\n        <el-button type=\"warning\" plain @click=\"take\">TAKE</el-button>\r\n        <el-button type=\"primary\" plain @click=\"open\">rule</el-button>\r\n<!--        <el-button type=\"primary\" plain @click=\"open\">SAVE</el-button>-->\r\n      </el-row>\r\n  </div>\r\n  <div>\r\n    <el-dialog\r\n        v-model=\"dialogVisible3\"\r\n        title=\"巨洞出口\"\r\n        width=\"30%\"\r\n        :before-close=\"handleClose\"\r\n    >\r\n      <span>恭喜你，获得了离开洞穴的钥匙，并离开了洞穴</span>\r\n      <template #footer>\r\n      <span class=\"dialog-footer\">\r\n        <el-button type=\"primary\" @click=\"gameWin()\">\r\n          确定\r\n        </el-button>\r\n      </span>\r\n      </template>\r\n    </el-dialog>\r\n      <el-dialog\r\n          v-model=\"dialogVisible4\"\r\n          title=\"game over\"\r\n          width=\"30%\"\r\n          :before-close=\"handleClose\"\r\n      >\r\n        <span>你体力不支，倒在了洞穴里</span>\r\n        <template #footer>\r\n      <span class=\"dialog-footer\">\r\n        <el-button type=\"primary\" @click=\"gameOver()\">\r\n          确定\r\n        </el-button>\r\n      </span>\r\n        </template>\r\n      </el-dialog>\r\n  </div>\r\n\r\n</template>\r\n\r\n<script>\r\nimport request from \"@/utils/request\";\r\nimport Header from \"@/components/Header.vue\";\r\nexport default {\r\n  // eslint-disable-next-line vue/multi-word-component-names\r\n  name: \"product\",\r\n  components: {Header},\r\n  data(){\r\n    return{\r\n      url:'',\r\n      form:{},\r\n      dialogVisible:false,\r\n      dialogVisible2:false,\r\n      dialogVisible3:false,\r\n      dialogVisible4:false,\r\n      currentPage:1,\r\n      pageSize:10,\r\n      total:10,\r\n      search:'',\r\n      tableData:[],\r\n      rooms:[{'name':'outside','id':1,'gold':'1','cost':'-1','descriptions':'outside the main entrance of the colossal cave','picture':'assets/images/outside.jpg','takeflag':0},\r\n        {'name':'theater','id':2,'gold':'2','cost':'-1','descriptions':'in the theater ,Mysterious songs are scattered throughout the opera house','picture':'assets/images/theater.jpg','takeflag':0},\r\n        {'name':'pub','id':3,'gold':'4','cost':'-3','descriptions':'in the quiet bar, the clinking sound of wine glasses','picture':'assets/images/pub.jpg','takeflag':0},\r\n        {'name':'lab','id':4,'gold':'3','cost':'-2','descriptions':'in a scientific laboratory, only the sound of machines running','picture':'assets/images/lab.jpg','takeflag':0},\r\n        {'name':'treasure','id':5,'gold':'5','cost':'-1','descriptions':'in the treasure room, maybe there has some treasure','picture':'assets/images/treasure.jpg','takeflag':0},\r\n        {'name':'randomRoom','id':6,'gold':'0','cost':'0','descriptions':'in a random room,where do you want to go','picture':'assets/images/randomroom.jpg','takeflag':1},\r\n        {'name':'exit','id':7,'gold':'0','cost':'0','descriptions':'a way to leave this place!','picture':'assets/images/exit.jpg','takeflag':0},\r\n        {'name':'corridor','id':8,'gold':'0','cost':'0','descriptions':'a long long corridor with cold wind','picture':'assets/images/corridor.jpg','takeflag':1}],\r\n      items:[{'name':'cookie','id':1,'roomId':5,'descriptions':'增加5体力'},\r\n        {'name':'key','id':2,'roomId':7,'descriptions':'通关的关键物品'}], //物品设置\r\n      location:'', //当前位置\r\n      gold:'', //金币\r\n      cost:'', //体力消耗\r\n      descriptions:'', //房间描述\r\n      id:'', //房间id\r\n      lastroom:'', //上次房间信息\r\n      powerFlag:false, //玩家体力状态\r\n      maps:[[1,2,3], [5,6,4], [8,7,0]] //地图\r\n    }\r\n  },\r\n  created() {\r\n    this.load()\r\n  },\r\n  methods:{\r\n    /**\r\n     * @description 游戏规则说明\r\n     * @return void\r\n     * */\r\n    open(){\r\n      this.$notify({\r\n        title: '游戏规则说明',\r\n        message: '巨洞探险：一个精彩的、充满想像力的复杂游戏，包括要在一个复杂的洞穴系统中找到出路、寻找隐藏的财宝、使用暗语和其他一些神秘工具，最终的目的是获得高分。',\r\n        duration: 4500\r\n      });\r\n    },\r\n    /**\r\n     * @description 获取随机数函数\r\n     * @param {int} min\r\n     * @param {int} max\r\n     * @return {int} 随机数值\r\n     * */\r\n    getRandomInt1(min, max) {\r\n      min = Math.ceil(min);\r\n      max = Math.floor(max);\r\n      return Math.floor(Math.random() * (max - min)) + min; //不含最大值，含最小值\r\n     },\r\n    /**\r\n     * @description 加载页面信息\r\n     * @return void\r\n     * */\r\n    load(){\r\n      request.get(\"/user\"\r\n      ).then(res=>{\r\n        this.tableData=res.data.records\r\n        this.total=res.data.total\r\n        let user=JSON.parse(sessionStorage.getItem(\"user\"))\r\n        for(let data in res.data.records){\r\n          if(res.data.records[data].id===user[\"id\"]){\r\n            this.location=res.data.records[data].currentroom\r\n            this.lastroom=res.data.records[data].lastroom\r\n          }\r\n        }\r\n        for(let index in this.rooms){\r\n            let map=this.rooms[index]\r\n            if(map['name']===this.location){\r\n              this.gold=map['gold']\r\n              this.cost=map['cost']\r\n              this.descriptions=\"Now,you are \"+map['descriptions']\r\n              this.id=map['id']\r\n              this.url=require(\"@/\"+this.rooms[this.id-1]['picture'])\r\n          }\r\n        }\r\n        if(this.location===\"randomRoom\"){\r\n          alert(\"您处于随机房间，将会被传送离开\")\r\n          this.portal()\r\n        }\r\n      })\r\n    },\r\n    /**\r\n     * @description 传送至randomRoom四周任意房间\r\n     * @return void\r\n     * */\r\n    portal(){\r\n      let a=this.getRandomInt1(1,5)\r\n      switch (a){\r\n        case 1:\r\n          this.move(0,-1)\r\n          break;\r\n        case 2:\r\n          this.move(0,1)\r\n          break;\r\n        case 3:\r\n          this.move(-1,0)\r\n          break;\r\n        case 4:\r\n          this.move(1,0)\r\n          break;\r\n      }\r\n    },\r\n    /**\r\n     * @description 拿取房间内物品\r\n     * @return void\r\n     * */\r\n    take(){\r\n      let judgeFlag\r\n      let num\r\n      for(let index in this.rooms){\r\n        if(this.rooms[index].name === this.location){\r\n          judgeFlag=this.rooms[index].takeflag\r\n          num=index\r\n        }\r\n      }\r\n      if(judgeFlag==1) {\r\n        alert(\"房间内无物品可以拿取\")\r\n      }else{\r\n        let oldgold\r\n        let oldcoin\r\n        request.get(\"/user\"\r\n        ).then(res=>{\r\n          let user=JSON.parse(sessionStorage.getItem(\"user\"))\r\n          for(let data in res.data.records){\r\n            if(res.data.records[data].id===user[\"id\"]){\r\n              oldgold=res.data.records[data].gold\r\n              oldcoin=res.data.records[data].coin\r\n            }\r\n          }\r\n          let gold=(parseInt(oldgold)+parseInt(this.gold)).toString()\r\n          let coin=(parseInt(oldcoin)+parseInt(this.cost)).toString()\r\n\r\n          let mesage=\"gold+\"+this.gold+\"  power\"+this.cost\r\n          for(let index in this.items){\r\n            if(this.items[index].roomId===parseInt(this.id)){\r\n              if(parseInt(coin)<0){\r\n                this.$message({\r\n                  type:\"error\",\r\n                  message:\"您的体力不足\"\r\n                })\r\n                return\r\n              }else{\r\n                coin=(parseInt(coin)+5).toString()\r\n                mesage=mesage+\" you get a \"+this.items[index].name+\" your power +5\"\r\n              }\r\n            }\r\n          }\r\n          let data={\"id\":user[\"id\"],\"name\":user[\"name\"],\"password\":user[\"password\"],\"gender\":user[\"gender\"],\"currentroom\":this.location,\"gold\":gold,\"coin\":coin}\r\n          request.put(\"/user\",data).then(res => {\r\n            console.log(res)\r\n            if(res.code===\"0\"){\r\n              this.$message({\r\n                type:\"success\",\r\n                message:mesage\r\n              })\r\n            }else {\r\n              this.$message({\r\n                type:\"error\",\r\n                message:res.msg\r\n              })\r\n            }\r\n            if(this.location===\"exit\"){\r\n              this.dialogVisible3=true\r\n            }\r\n            this.load()\r\n          })\r\n        })\r\n        judgeFlag=1\r\n        this.rooms[num].takeflag=1\r\n      }\r\n    },\r\n    /**\r\n     * @description 刷新用户信息\r\n     * */\r\n    refresh(){\r\n      let oldgold\r\n      let oldcoin\r\n      request.get(\"/user\"\r\n      ).then(res=>{\r\n        let user=JSON.parse(sessionStorage.getItem(\"user\"))\r\n        for(let data in res.data.records){\r\n          if(res.data.records[data].id===user[\"id\"]){\r\n            oldgold=res.data.records[data].gold\r\n            oldcoin=res.data.records[data].coin\r\n          }\r\n        }\r\n        oldcoin=(parseInt(oldcoin)-1).toString()\r\n        if(parseInt(oldcoin)<=0){//体力不足\r\n          this.dialogVisible4=true\r\n        }else{\r\n          let data={\"id\":user[\"id\"],\"name\":user[\"name\"],\"password\":user[\"password\"],\"gender\":user[\"gender\"],\"currentroom\":this.location,\"gold\":oldgold,\"coin\":oldcoin,\"lastroom\":this.lastroom}\r\n          request.put(\"/user\",data).then(res => {\r\n            if(res.code===\"0\"){\r\n              this.$message({\r\n                type:\"success\",\r\n                message:\"成功\"\r\n              })\r\n            }else {\r\n              this.$message({\r\n                type:\"error\",\r\n                message:res.msg\r\n              })\r\n            }\r\n            this.load()\r\n          })\r\n        }\r\n      })\r\n    },\r\n    /**\r\n     * @description 获取当前地图上玩家所处的位置\r\n     * @return {array} 玩家所处的位置坐标数组，例如 [x, y]，x 表示行，y 表示列\r\n     **/\r\n    getPlayerPosition() {\r\n      for(let i = 0; i < 3; i++) {\r\n        for(let j = 0; j < 3; j++) {\r\n          if(this.maps[i][j] === this.id) {\r\n            return [i, j];\r\n          }\r\n        }\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @description 判断新位置是否有效\r\n     * @param {array} newPosition 新位置的坐标数组，例如 [x, y]，x 表示行，y 表示列\r\n     * @return {boolean} 若新位置有效则返回 true，否则返回 false\r\n     **/\r\n    isValidPosition(newPosition) {\r\n      const [x, y] = newPosition;\r\n      return x >= 0 && y >= 0 && x <= 2 && y <= 2 && this.maps[x][y] !== 0;\r\n    },\r\n\r\n    /**\r\n     * @description 根据新位置更新玩家状态\r\n     * @param {array} newPosition 新位置的坐标数组，例如 [x, y]，x 表示行，y 表示列\r\n     * @return void\r\n     **/\r\n    updatePlayerStatus(newPosition) {\r\n      for(let index in this.rooms) {\r\n        let map=this.rooms[index]\r\n        if(map['id']===this.maps[newPosition[0]][newPosition[1]]){\r\n          this.location=map['name']\r\n          this.refresh()\r\n        }\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @description 移动玩家到新位置\r\n     * @param {int} deltaX 表示南北方向的移动\r\n     * @param {int} deltaY 表示东西方向的移动\r\n     * @return void\r\n     **/\r\n    move(deltaX, deltaY) {\r\n      const [x, y] = this.getPlayerPosition();\r\n      const newPosition = [x + deltaX, y + deltaY];\r\n      if (this.isValidPosition(newPosition)) {\r\n        this.updatePlayerStatus(newPosition);\r\n      } else {\r\n        alert(\"此路不通\");\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @description 返回上一房间\r\n     * @return void\r\n     * */\r\n    back(){\r\n      let lastroom = this.lastroom\r\n      this.lastroom=this.location\r\n      this.location=lastroom\r\n      this.refresh()\r\n    },\r\n    /**\r\n     * @description 保存状态信息\r\n     * @return void\r\n     * */\r\n    save(){\r\n      if(this.form.id){\r\n        request.put(\"/user\",this.form).then(res => {\r\n          console.log(res)\r\n          if(res.code===\"0\"){\r\n            this.$message({\r\n              type:\"success\",\r\n              message:\"更新成功\"\r\n            })\r\n          }else {\r\n            this.$message({\r\n              type:\"error\",\r\n              message:res.msg\r\n            })\r\n          }\r\n          this.load()\r\n          this.dialogVisible=false\r\n        })\r\n      }\r\n    },\r\n    // eslint-disable-next-line no-unused-vars\r\n    /**\r\n     * @description 游戏胜利\r\n     * @return void\r\n     * */\r\n    gameWin(){\r\n      this.dialogVisible3 = false\r\n      this.reset()\r\n    },\r\n    /**\r\n     * @description 游戏结束（未获胜）\r\n     * @return void\r\n     * */\r\n    gameOver(){\r\n      this.dialogVisible4 = false\r\n      this.reset()\r\n    },\r\n    /**\r\n     * @description 重置玩家状态\r\n     * @return void\r\n     * */\r\n    reset(){\r\n      request.get(\"/user\"\r\n      ).then(res=>{\r\n        let user=JSON.parse(sessionStorage.getItem(\"user\"))\r\n        let oldgold\r\n        let oldcoin\r\n        for(let data in res.data.records){\r\n          if(res.data.records[data].id===user[\"id\"]){\r\n            oldgold=res.data.records[data].gold\r\n            oldcoin=res.data.records[data].coin\r\n          }\r\n        }\r\n        oldgold = \"0\"\r\n        oldcoin = \"20\"\r\n        let data={\"id\":user[\"id\"],\"name\":user[\"name\"],\"password\":user[\"password\"],\"gender\":user[\"gender\"],\"currentroom\":\"outside\",\"gold\":oldgold,\"coin\":oldcoin}\r\n        request.put(\"/user\",data).then(res => {\r\n          console.log(res)\r\n          if(res.code===\"0\"){\r\n            this.$message({\r\n              type:\"success\",\r\n              message:res.msg\r\n            })\r\n          }else {\r\n            this.$message({\r\n              type:\"error\",\r\n              message:res.msg\r\n            })\r\n          }\r\n          this.load()\r\n        })\r\n      })\r\n      for(let index in this.rooms){\r\n        this.rooms[index].takeflag=0\r\n      }\r\n      this.rooms[8].takeflag=1\r\n      this.rooms[6].takeflag=1\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n\r\n<style scoped>\r\n.a{\r\n  margin: auto;\r\n  position: absolute;\r\n  top: 50px;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n}\r\n.b{\r\n  margin: auto;\r\n  position: absolute;\r\n  top: 160px;\r\n  left: 400px;\r\n  right: 0;\r\n  bottom: 0;\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}